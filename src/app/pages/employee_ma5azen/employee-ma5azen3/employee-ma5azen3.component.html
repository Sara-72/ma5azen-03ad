<app-header> </app-header>

<div class="content d-flex flex-row">
  <aside class="sidebar">
    <h5>مرحباً بك </h5>
    <ul class="mt-5">
      <li><a href="/employee_ma5azen1">دفتر المالية</a></li>
      <li><a href="/employee_ma5azen2">كاتب الشطب</a></li>
      <li class="active"><a>المخزن</a></li>
      <li><a href="/employee_ma5azen4">مخزن الأمين</a></li>
    </ul>
  </aside>

  <form
    [formGroup]="simpleForm"
    (ngSubmit)="onSubmit()"
    dir="rtl"
    class="mt-5 form-part"
  >
    <div class="table-section">
      <table>
        <thead>
          <tr>
            <th>الفئة</th>
            <th>الصنف</th>
            <th>العدد</th>
          </tr>
        </thead>

        <tbody formArrayName="tableData">
          @for (rowGroup of tableData.controls; track $index) {
          <tr [formGroupName]="$index">
            <td>
              <select formControlName="category" class="table-input">
                <option value="" disabled selected hidden>اختر فئة</option>
                @for (category of categories; track category) {
                <option [value]="category">{{ category }}</option>
                }
              </select>
            </td>

            <td>
              <select formControlName="item" class="table-input">
                <option [ngValue]="null" disabled selected hidden>
                  اختر صنف
                </option>
                @for (item of availableItemsByRow[$index]; track item) {
                <option [value]="item">{{ item }}</option>
                }
              </select>
            </td>

            <td>
              <input type="text" formControlName="count" class="table-input" />
            </td>
          </tr>
          }
        </tbody>
      </table>

      <div class="row-controls">
        <button type="button" class="remove-row-button" (click)="removeRow()">
          -
        </button>
        <button type="button" class="add-row-button" (click)="addRow()">
          +
        </button>
      </div>
    </div>

    <button
      type="submit"
      [disabled]="isSubmitting() || simpleForm.invalid"
      class="submit-btn mt-4"
    >
      @if (isSubmitting()) { جاري الحفظ... } @else { حفظ البيانات }
    </button>
  </form>
</div>

<app-footer> </app-footer>
